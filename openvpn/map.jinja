{% import_yaml "openvpn/defaults.yaml" as defaults %}
{% import_yaml "openvpn/osfamilymap.yaml" as osfamilymap %}
{% import_yaml "openvpn/osmap.yaml" as osmap %}
{% import_yaml "openvpn/osfingermap.yaml" as osfingermap %}

{% do defaults.openvpn.update({'multi_services': salt['grains.has_value']('systemd')}) %}

{% set mapdata = salt['grains.filter_by'](
    defaults,
    merge=salt['grains.filter_by'](
        osfamilymap,
        grain='os_family',
        merge=salt['grains.filter_by'](
            osmap,
            grain='os',
            merge=salt['grains.filter_by'](
                osfingermap,
                grain='os',
                merge=salt['pillar.get']('openvpn:lookup', {}),
            ),
        ),
    ),
    base='openvpn')
 %}
